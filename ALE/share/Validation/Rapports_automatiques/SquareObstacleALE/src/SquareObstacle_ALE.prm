Parameters {
        Title "Translating square cylinder"
        Author "R. P. and M. A. P"
	ParametersTRUST Problem : Pb_hydraulique
	ParametersTRUST Dimension : 2D
	ParametersTRUST Domain : Domaine_ALE
	ParametersTRUST Discretization : VEFPre1B
	ParametersTRUST Time scheme : Scheme_euler_explicit and Scheme_euler_implicit
	ParametersTRUST Medium : Fluide_Incompressible
	ParametersTRUST Hydraulic problem : Navier_Stokes_standard
        ParametersTRUST Convection scheme: amont and muscl
        Description This test case was created to validate TrioCFD with ALE discretization through the SPHERIC benchmark[1]. The geometry is taken from [1] and the test case with Reynolds number equal to 50 was chosen.
	Description In this test a flow across a horizontally moving square is investigated in a tank. The initial square is not moving and it reaches its maximum velocity within one second.
	IncludeData 1
        Reference "1. A. Colagrossi, 'SPHERIC benchmark 6: 2D Incompressible flow around a moving square inside a rectangular box. - 2D SPH Validation.', SPHERIC, [Online]. Available: http://spheric-sph.org/tests/test-6. [Accessed Sept. 29, 2017]."
      
	 TestCase  Amont SquareObstacle_ALE.data 
	 TestCase  Muscl SquareObstacle_ALE.data
	 TestCase  Implicit SquareObstacle_ALE.data   /*jdd en annexe*/ 
	 
}

Chapter {
	Title "Drag coefficient pressure component"

	Figure {
		Title "Drag coefficient pressure component"
		Description "The drag coefficient pressure component \latex_( $C_{d}(\text{pressure component})=\Delta p /(0.5 \cdot \rho \cdot U_{max}^{2})$ \latex_), where \latex_( $\rho=1 \frac{kg}{m^{3}}, U_{max}=1 \frac{m}{s} (\text{maximum velocity of the obstacle})$ \latex_), is plotted for the following cases: SPHERIC benchmark, TrioCFD with amont convection scheme and Euler explicit time scheme (TrioCFD Amont/Exp), for TrioCFD with muscl convection scheme and Euler explicit time scheme (TrioCFD Muscl/Exp), and  for TrioCFD with muscl convection scheme and Euler implicit time scheme (TrioCFD Muscl/Imp)."
		LabelX "t"
		LabelY "Cd (pressure component)"
		include_description_curves 0
		Courbe {
			legend "SPHERIC benchmark"
			Fichier ReferenceSolution.csv
			Style linespoints
		}
		Courbe {
			legend "TrioCFD Amont/Exp"
			file ./Amont/SquareObstacle_ALE_SONDE_DRAG_COEF_PRESSURE_COMP.son
			Style linespoints

		}
		Courbe {
			legend "TrioCFD Muscl/Exp"
			file ./Muscl/SquareObstacle_ALE_SONDE_DRAG_COEF_PRESSURE_COMP.son
			Style linespoints

		}
		Courbe {
			legend "TrioCFD Muscl/Imp"
			file ./Implicit/SquareObstacle_ALE_SONDE_DRAG_COEF_PRESSURE_COMP.son
			Style linespoints

		}
	}
}

Chapter {
	Title "Probes: 1D Plots using the Euler explicit time scheme "
	Description "There is no analysis for the results in this section, that are just non-regression plots. "
	Figure { 
		title "Pressure along line Y=1.5 "
		include_description_curves 0
		labelX "X"
		labelY "Pressure"

		Courbe {
			Legende "Pressure: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H1 
			Style linespoints

			}

		Courbe {
			Legende "Pressure: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H1 
			Style linespoints

			}
	}

	Figure { 
		title "Pressure along line Y=2.5 "
		include_description_curves 0
		labelX "X"
		labelY "Pressure"

		Courbe {
			Legende "Pressure: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H2 
			Style linespoints

			}

		Courbe {
			Legende "Pressure: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H2 
			Style linespoints

			}
	}
	Figure { 
		title "Pressure along line Y=3.5 "
		include_description_curves 0
		labelX "X"
		labelY "Pressure"

		Courbe {
			Legende "Pressure: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H3 
			Style linespoints

			}

		Courbe {
			Legende "Pressure: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H3 
			Style linespoints

			}
	}

	Figure { 
		title "Velocity along line X= 0.8 "
		include_description_curves 0
		labelX "Y"
		labelY "Vx"

		Courbe {
			Legende "Pressure: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_V1
			Style linespoints

			}

		Courbe {
			Legende "Pressure: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_V1
			Style linespoints

			}
	}
	Figure { 
		title "Pressure along line X= 2.5 "
		include_description_curves 0
		labelX "Y"
		labelY "Pressure"

		Courbe {
			Legende "Pressure: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_V2
			Style linespoints

			}

		Courbe {
			Legende "Pressure: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_V2
			Style linespoints

			}
	}


	Figure { 
		title "Velocity along line Y=1.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vx"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H1
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H1
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=1.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vy"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H1
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H1
			Style linespoints

			}
	}

	Figure { 
		title "Velocity along line Y=2.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vx"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H2
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H2
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=2.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vy"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H2
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H2
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=3.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vx"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H3
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H3
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=3.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vy"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H3
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H3
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=0.8 "
		include_description_curves 0
		labelX "Y"
		labelY "Vx"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_V1
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_V1
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=0.8 "
		include_description_curves 0
		labelX "Y"
		labelY "Vy"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_V1
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_V1
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=2.5 "
		include_description_curves 0
		labelX "Y"
		labelY "Vx"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_V2
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_V2
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=2.5 "
		include_description_curves 0
		labelX "Y"
		labelY "Vy"

		Courbe {
			Legende "Velocity: Amont"
			segment ./Amont/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_V2
			Style linespoints

			}

		Courbe {
			Legende "Velocity: Muscl"
			segment ./Muscl/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_V2
			Style linespoints

			}
	}

}	



Chapter {
	Title "Probes: 1D Plots. Results obtained with the Euler implicit time scheme. The convection scheme is muscl"
	Description "There is no analysis for the results in this section, that are just non-regression plots. "
	Figure { 
		title "Pressure along line Y=1.5 "
		include_description_curves 0
		labelX "X"
		labelY "Pressure"

		Courbe {
			Legende "Pressure"
			segment ./Implicit/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H1 
			Style linespoints

			}
	}

	Figure { 
		title "Pressure along line Y=2.5 "
		include_description_curves 0
		labelX "X"
		labelY "Pressure"

		Courbe {
			Legende "Pressure"
			segment ./Implicit/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H2 
			Style linespoints

			}
	}
	Figure { 
		title "Pressure along line Y=3.5 "
		include_description_curves 0
		labelX "X"
		labelY "Pressure"

		Courbe {
			Legende "Pressure"
			segment ./Implicit/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_H3 
			Style linespoints

			}

	}

	Figure { 
		title "Velocity along line X= 0.8 "
		include_description_curves 0
		labelX "Y"
		labelY "Vx"

		Courbe {
			Legende "Pressure"
			segment ./Implicit/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_V1
			Style linespoints

			}
	}
	Figure { 
		title "Pressure along line X= 2.5 "
		include_description_curves 0
		labelX "Y"
		labelY "Pressure"

		Courbe {
			Legende "Pressure:"
			segment ./Implicit/SquareObstacle_ALE SONDE_PRESSION_SEGMENT_V2
			Style linespoints

			}
	}


	Figure { 
		title "Velocity along line Y=1.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vx"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H1
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=1.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vy"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H1
			Style linespoints

			}
	}

	Figure { 
		title "Velocity along line Y=2.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vx"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H2
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=2.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vy"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H2
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=3.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vx"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_H3
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line Y=3.5 "
		include_description_curves 0
		labelX "X"
		labelY "Vy"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_H3
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=0.8 "
		include_description_curves 0
		labelX "Y"
		labelY "Vx"


		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_V1
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=0.8 "
		include_description_curves 0
		labelX "Y"
		labelY "Vy"


		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_V1
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=2.5 "
		include_description_curves 0
		labelX "Y"
		labelY "Vx"


		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEX_SEGMENT_V2
			Style linespoints

			}
	}
	Figure { 
		title "Velocity along line X=2.5 "
		include_description_curves 0
		labelX "Y"
		labelY "Vy"

		Courbe {
			Legende "Velocity"
			segment ./Implicit/SquareObstacle_ALE SONDE_VITESSEY_SEGMENT_V2
			Style linespoints

			}
	}

}	




Chapter {
	Title "Visualization via VisIt Convection Amont and Euler explicit time scheme" 


	visu {
		title "PRESSION SOM"
		pseudocolor ./Amont/SquareObstacle_ALE.lata dom PRESSION SOM
	}
	visu {
		title "VITESSE x-component"
		pseudocolor PAR_RotationALE.lata dom VITESSE_X FACES
	}
	visu {
		title "VITESSE y-component"
		pseudocolor PAR_RotationALE.lata dom VITESSE_Y FACES
	}


}




Chapitre {
	Titre "Conclusion"
	Description The 2D SPHERIC benchmark [1] reference results were compared with the ALE results. ALE simulations with the same mesh size ($\Delta x$ =0.0167) as used in the benchmark  can not be used. ALE method is usable with relatively small movements. Combining small mesh size with relatively big movement would produce low quality mesh at the end of this movement. Therefore ALE results are obtained from cases having nearly 3 times bigger mesh size ($\Delta x$=0.05).  By comparing solutions obtained with the reference solution it can be concluded that the former gives slightly lower values.
}
