Parameters {
	Title "ALE (Arbitrary Lagrange-Euler)"
	
	Author "tsidabde"
	
	VersionTrio_U 1.7.3
	
 	TestCase ./test_fixe test.data
 	TestCase ./test_ALE  test.data
	
	IncludeData 0
	
	Description "The ALE (Arbitrary Lagrange-Euler) model of TrioCFD is tested on an academic case (flow in a plane channel)."
	Description "The results on mobile mesh are presented and are compared with the results on fixed mesh as reference."
	Description "The validation process is detailed in the chapter 5 (Impl\'ementation de la m\'ethodologie ALE sous TrioCFD) of the Technical Note [1]."
	
	Reference "1: Simulation num\'erique des efforts exerc\'es sur un faisceau de tubes soumis \`a un \'ecoulement transverse. Sofiane Houbar. CEA Note technique DEN STMF/LMSF/NT/16-006/A - 30 ao\^ut 2106."

	ParametersTrio_U Dimension : 2
	ParametersTrio_U Problem : hydraulic (Poiseuille)
	ParametersTrio_U Discretization : VEFPreP1B
	ParametersTrio_U Time scheme : explicit Euler
	ParametersTrio_U Pressure solver : GCP
	ParametersTrio_U Convection scheme : ALE
}

#########################################################################################################################

Chapter {
	Title "Test description"
	visu {
		Title "Tetrahedral mesh"
		Description "Fixed mesh, 400 elements:"
		mesh ./test_ALE/test_POST_DOM_FIXE.lata dom_fixe
	}
	visu {
		Title "Physical model"
		Description "Plane channel:"
		Description " - Lx = 1m"
		Description " - Ly = 1m"
		Description "Type of fluid:"
		Description " - $\rho$ = 2 kg/m$^3$"
		Description " - $\mu$ = 0.25 Pa.s"
		Description "Boundary conditions:"
		Description " - Haut - Bas: fixed-wall"
		Description " - Haut - Bas: fixed-wall"
		Description " - Entree: fixed-pressure Pinlet = 20Pa"
		Description " - Sortie: fixed-pressure Poutlet =  0Pa"
		Description "Poiseuille solution:"
		Description " - $U(y)$ =$10*(1-4*y^2)$"
		Description "Initial conditions:"
		Description " - fluid at rest"
		Description "Nodes velocity on the ALE domain:"
		Description " - Haut - Bas: $\vec U$ = $( 1*sin(6.28/2*x})*cos(20*t);  0)$"
		Description " - Entree - Sortie: $\vec U$ = $( 0 ; 1*cos(6.28/2*y)*cos(20*t))$"
		Description "Mobile mesh, 400 elements:"
		mesh ./test_ALE/test.lata dom
	}
}

#########################################################################################################################

Chapter {
	Title "Calculation results"
	Figure {
		Title "Convergence"
		Description "Evolution of velocity residue:"
		Title_figure "max|dU/dt|"
		labelx "time"
		labely "residue"
		logX 
		logY 
		curve {
			legend "without ALE model"
			file ./test_fixe/test.dt_ev
			columns ($1) ($6)
			style linespoints
		}
		curve {
			legend "with ALE model"
			file ./test_ALE/test.dt_ev
			columns ($1) ($6)
			style linespoints
		}
		include_description_curves 0
	}
	visu {
		Title "Pressure"
		Description "Pressure pseudocolor without ALE model:"
		pseudocolor ./test_fixe/test.lata dom PRESSION_PA SOM
	}
	visu {
		Description "Pressure pseudocolor with ALE model:"
		pseudocolor ./test_ALE/test_POST_DOM_FIXE.lata dom_fixe PRESSION_PA SOM
	}
	Figure {
		Description "Comparison with Poiseuille solution:"
		Title_figure "P(x) = 20*(1-x) on y=0.0"
		labelx "X-axis"
		labely "PRESSION_PA"
		rangex 0. 1.
		rangey -1. 21.
		curve {
			legend "without ALE model"
			segment ./test_fixe/test.data RES_PX
			style linespoints
		}
		curve {
			legend "with ALE model"
			segment ./test_ALE/test.data RES_PX_FIXE
			style linespoints
		}
		curve {
			legend "Poiseuille data"
			segment ./test_fixe/test.data SOL_PX
			style lines
		}
		include_description_curves 0
	}
	visu {
		Title "Velocity"
		Description "Velocity pseudocolor without ALE model:"
		pseudocolor ./test_fixe/test.lata dom VITESSEX SOM
	}
	visu {
		Description "Velocity pseudocolor with ALE model:"
		pseudocolor ./test_ALE/test_POST_DOM_FIXE.lata dom_fixe VITESSEX SOM
	}
	Figure {
		Description "Comparison with Poiseuille solution:"
		Title_figure "U(y) = 10*(1-4*y^2) on x=0.5"
		labelx "Y-axis"
		labely "VITESSEX"
		rangex -0.5 0.5
		rangey -1. 11.
		curve {
			legend "without ALE model"
			segment ./test_fixe/test.data RES_UY
			style linespoints
		}
		curve {
			legend "with ALE model"
			segment ./test_ALE/test.data RES_UY_FIXE
			style linespoints
		}
		curve {
			legend "Poiseuille data"
			segment ./test_fixe/test.data SOL_UY
			style lines
		}
		include_description_curves 0
	}
}

#########################################################################################################################

Chapter {
	Title "Conclusion"
	Description "There is no yet conclusion about the comparison between the reference Poiseuille case on fixed mesh and the case with ALE model on mobile mesh because the ALE calculation do not converge."
}

#########################################################################################################################

Chapter {
    Title "Data file"
    Description include_text_file(test_ALE.data)
}
