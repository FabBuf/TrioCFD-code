Parameters {
	newvalidTrio
#
	Title "A posteriori error estimator - FVCA8 Benchmark test 5"
#
	VersionTrio_U "1.8.5"
#
	ParametersTrio_U Type of problem: 3D laminar hydraulic_problem
	ParametersTrio_U Discretization: VEFPreP1B
	ParametersTrio_U Time scheme: Explicit Euler and VEF
	ParametersTrio_U Momentum convection scheme: EF_stab with \latex_($\alpha = 0.5$\latex_)
	ParametersTrio_U Solving of equations: Navier_Stokes_standard
	ParametersTrio_U Master Test case: cc_re100.data
	ParametersTrio_U Location: Optimisation/Aposteriori/share/Validation/Rapports_automatiques/FVCA05_posteriori_stationnaire
#
	Reference " $[1]$ Chabard J.P, Lalanne P., Metivet B., Projet N3S de Mecanique des fluides. Cahier de Validation 2D. EDF/DER HE-41/88.08 1988. "
	
#
#
	TestCase EI/Muscl test \*
	TestCase EI/EF_stab02 test
#
	Author "E. MOREAU (S. VANDROUX)"
	IncludeData 2
}
Objectif {
	Description "The purpose of the validation is to compare numerical values of an oscillating flow behind a circular cylinder perpendicular to the flow with those obtanined by calculations and experiments. "
	Description " \latex_(\underline{Validated model:}\latex_)
	Description "	- No-slip wall "
	Description "	- 2D channel "
	Description "	- Disturbance of a laminar flow "
	Description " "
	Description " \latex_(\underline{Validation with:}\latex_) Calculations N3S of Chabard $[1]$ and experiments of Braza et al. $[2]$
}
#
Pb_description {
	Description "In order to observe the disturbances generated by a circular obstacle in an initially laminar flow, we define here a rectangular channel having at mid-height a hole which will correspond to the obstacle. The geometric dimensions of these different elements are given below as well as the conditions necessary for the establishment of the initial laminar flow at the beginning of the transient. "
	geometrie {
		Description "In the follwing scheme, L = 0.635m ; W = 0.1524m and d = 0.0254m "
		Figure {
			Title "Geometry"
			Width 14cm
			picture geometry.png
		}
	}
	CICL {
		Description "Hydraulic initial conditions: quiescent fluid U = V = 0 m/s "
		Description "Hydraulic boundary condition: "
		Description " $\bullet$ The X-velocity is imposed in order to obtain U = 0.03937m/s so that Re = Ud/$\nu$ = 100 "
		Description " $\bullet$ CERCLE : paroi_fixe "
		Description " $\bullet$ PAROI1 : symetrie "
		Description " $\bullet$ PAROI2 : symetrie "
		Description " $\bullet$ SORTIE : frontiere_ouverte_pression_imposee Champ_Front_Uniforme 1 0.0 "
		Description " $\bullet$ SORTIE : frontiere_ouverte_vitesse_imposee Champ_Front_Uniforme 2 0.03937 0.0 "
	}
	Propfluide {
		Description "The fluid used in this test is fictive with the following properties :"
		Table {
			Title "Physical properties of the fictitious fluid"
			Description " "
			nb_columns 1
			label Value
			line {
				legend " $\rho$ (kg/$m^3$) "
				file propertiesGeometry.dat     
				nb_columns_file 3
				columns ($1)
			}
			line {
				legend " $\mu$ (N/$m^2$/s) "
				file propertiesGeometry.dat     
				nb_columns_file 3
				columns ($2)
			}
			line {
				legend " Re "
				file propertiesGeometry.dat     
				nb_columns_file 3
				columns ($3)
			}
		}
	}
	Phyecou {
		Description "At the beginning of the transient, fluid flow is completely laminar with the Reynolds number equal to 100. In view of the characteristics defined for the fluid, this flow will be quickly disturbed by the obstacle present in the mid-hight of the channel. "
	}
}
#
Casesetup {
	Maillage {
		Description " The mesh was built with gmesh and has 9668 elements. It is a tetraedric mesh, homogeneous over most of the domain with a refinement around the central obstacle in order to capture the formation of the boundary layer around the cylinder induced by the adverse pressure gradient. This refinement will optimize the recirculation phenomena around the cylinder and reveal the development of turbulence in an initially laminar flow. "
		visu {
			Title "Mesh overview"
			Width 14cm, trim= 100 100 50 650,clip
			mesh EI/Muscl/test.lata dom
		}
		visu {
			Title "Zoom of the vicinity of the cylinder"
			Description " Triangle layer with 200 points around the circle "
			Width 10cm, viewport= 0 100 1000 1000,clip
			mesh EI/Muscl/test.lata dom
			zoom2D 0.1133 0.141 0.0625 0.09
		}
	}
#
	Options_modele {
		Description " $\bullet$ The case modeled here being a laminar hydraulic problem, the equations solved are those of standard Navier-Stokes. "
		Description " $\bullet$ \latex_(\underline{Momentum convection scheme:}\latex_) EF_stab with \latex_($\alpha = 0.2$\latex_) or Muscl."
		Description " $\bullet$ \latex_(\underline{Diffusion scheme:}\latex_) default
	}
#
	Autres_options {
		Description " $\bullet$ The time scheme defined in this test case is the Explicit Euler with implicit diffusion. Indeed, \latex_(\textbf{the Euler implicit scheme is not recommanded}\latex_) because, as the calculation presents oscillations, the value of the facsec coefficient must remain small. The calculation time is then increased instead of being improved. "
		Description " $\bullet$ The pressure variable to be employed in the data file is not 'Pression' but 'Pression_Pa', that gives the pressure in Pa. "
	}

}
#
Results {
# Validation specific informations automatically generate
	Description " The temporal pressure evolution at two probes located on the cylinder surface (y = -0.5d and  y = +0.5d) is shown in the following figure for each convection scheme. The simulations have been perfomed up to 90s of physical time in order to get sufficient cycles allowing the calculation of a frequency. "
	Description " \latex_(\medskip \latex_) 
	Description "$\bullet$ \latex_(\textbf{Von Karman vortices}\latex_) "
	Description " When a viscous Newtonian fluid flows around a cylinder, the latter is subjected to forces from the surrounding fluid and complex Reynolds number-dependent phenomena appear. Near the surface of the cylinder wall in contact with the flow, a thin layer of viscous fluid (boundary layer) forms. In this, a speed gradient is established due to viscous stresses which are not negligible. The closer the fluid is to the wall, the more braked, the speed being zero at the surface of the cylinder to satisfy the condition grip. This redistribution in the velocity field leads to a diffusion of the momentum, either by a viscous mechanism or by turbulent movements induced by vortex detachment. "
	Description " At a specific point, the friction is canceled out and the boundary layer lifts off the wall; this is the point of separation. This separation is not due to the singularity in the geometry, as it would have been the case for a square cylinder, but to the fact that the boundary layer develops in the presence of a pressure gradient that we can observe in the following figure in the pressure field of the domain. "
	visu {
		Title "Pressure fields at t = 90s "
		Width 14cm, viewport= 100 100 1000 350,clip
		Pseudocolor EI/Muscl/test.lata dom PRESSION_PA ELEM
		cycles -1
	}
	Description " When this pressure gradient is large enough, the speed fluid particles will decrease until they become zero then negative and the separation of the boundary layer occurs.
	Description " Behind the cylinder, we can see the development of Karman vortex street caused by a vortex shedding. The chacarteritics of the fictitious fluid examined here as well as the Reynolds number were establised in this academic test case in oder to reveal these instabilities. "
	Description " The boundary layer fluid reaches the detachment area around \latex_($\pm \frac{\pi}{2}$ \latex_) and when its kinetic energy is insufficient to pass further downstream of the cylinder where the pressure is greater, the fluid tends to take off thus generating a recirculation vortex. This vortex, after reaching a certain size, detaches itself from the layer limit and is convected in the wake. The downstream flow then takes shape of a vortex path and the boundary layer peels off from the cylinder wall. "
	Description " The wake of the flow will be different depending on the Reynolds number. For Re = 100, which will correspond to the case modeled here, the wake of the flow becomes asymmetric and unstable. This gives rise to the phenomenon of vortex detachment: vortices form on each side of the cylinder and are alternately convected in the wake forming an street of laminar vortices, called Von Karman vortices. This detachment is done periodically and two-dimensional, that is to say that the detachment does not take place in the transverse direction (Williamson $[3]$).
	Description " We can observe the establishment of this type of vortex in the figure below. "
	visu {
		Title "Velocity vectors at t = 90s "
		Width 14cm, viewport= 100 100 1000 350,clip
		Vector EI/Muscl/test.lata dom VITESSE ELEM 0.2
		cycles -1
	}

	Description "$\bullet$ \latex_(\textbf{Pressure evolution at the cylinder surface}\latex_) "
	Description " It can be seen that the time of stabilization of the oscillations is of about 40s. From this instant, an oscillation frequency can be determined. " 
	Figure {
		Title " Pressure course at the cylinder surface at y = \latex_($\pm$\latex_)0.5d with a Muscl convection scheme "
		Description "$$\ $$ "
		Width 11.5cm
		Dimension 2

		LabelX " time (s)"
		RangeX 0 90
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
#
	Figure {
		Title " Pressure course at the cylinder surface at y = \latex_($\pm$\latex_)0.5d with an EF_stab (\latex_($\alpha = 0.2$\latex_)) convection scheme "
		Width 11.5cm
		Dimension 2

		LabelX " time (s)"
		RangeX 0 90
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
#pressure oscillations time from 40 up to 50s
#
	Description " The two following figures represent a zoom of the two previous figures from 40 up to 50s. We can notice that oscillations are well established in this time range. "
	Figure {
		Title " Zoom of the pressure evolution at the cylinder surface (Muscl) "
		Width 11.5cm
		Dimension 2

		LabelX " time (s)"
		RangeX 40 50
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
#
	Figure {
		Title " Zoom of the pressure evolution at the cylinder surface (EF_stab with alpha = 0.2) "
		Width 11.5cm
		Dimension 2

		LabelX " time (s)"
		RangeX 40 50
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
	Description "$\bullet$ \latex_(\textbf{Comparison of Strouhal numbers}\latex_) "
	Description " The temporal pressure evolution in the media allows the determination of the Strouhal number \latex_($S_{t}$\latex_) defined as \latex_($S_{t}=\frac{f.d}{U}$\latex_), where $f$ stands for the vortices emission frequency, $U$ the undisturbed velocity (in our case the inlet velocity), and $d$ the cylinder diameter. We can in this way compare the simulation values with those of Tritton and Roshko collected by Chabard $[1]$. "
	Table {
		Title " Comparison of Strouhal numbers "
		nb_columns 4
		label Frequency (Hz)| Stroual Number| Error % (Tritton)| Error % (Roshko)
		line {
			legend " Tritton "
			values 0.243 0.157 0 6
		}
		line {
			legend " Roshko "
			values 0.259 0.167 6 0
		}
		line {
			legend " Muscl "
			file ./EI/Muscl/strouhal.dat
			nb_columns_file 4
			last_line
			columns ($1) ($2) ($3) ($4)
		}
		line {
			legend " EF_stab (\latex_($\alpha = 0.2$\latex_)) "
			file ./EI/EF_stab02/strouhal.dat
			nb_columns_file 4
			last_line
			columns ($1) ($2) ($3) ($4)
		}
	}
	Description " Variations in the Strouhal number are associated with changes in the flow structure as described by Blevins $[4]$. For flow around a circular cylinder at \latex_($Re \sim 40 - 3 \times 10^7$\latex_), Williamson $[5]$, Roshko $[6]$ and Schewe $[7]$ observed experimentally that the Strouhal number is close to the value 0.2."
	Description " In the case we are modeling here, the value of the Reynolds number is included in this interval (Re = 100) and we note that the Strouhal number obtained numerically is equal to 0.2 to \latex_($10^{-3}$\latex_)."
	Description " \latex_(\medskip \latex_) 
	Description "$\bullet$ \latex_(\textbf{Mean Pressure}\latex_) "
	Description " The distribution of the mean pressure along the cylinder surface (averaged from 40s up to 90s) is shown and compared to values of N3S $[1]$ and Braza $[2]$ " 
	Figure {
		Title " Comparison of the mean pressure distribution along the cylinder surface with different convection and time schemes "
		Width 14cm
		Dimension 2
		LabelX " Angle (°)"
		RangeX 180 0
		LabelY "Mean Pressure (Pa)"
		RangeY -0.0015 0.0015
		Include_Description_Curves 0
		Curve {
			legend " Muscl "
			origin "Trio_U"
			Segment EI/Muscl/test.data SONDE_PMOY1
			columns 1 2
			Style lines
			TypeLigne 1 
		}
		Curve {
			legend " EF_stab (\latex_($\alpha = 0.2$\latex_)) "
			origin "Trio_U"
			Segment EI/EF_stab02/test.data SONDE_PMOY1
			columns 1 2
			Style lines
			TypeLigne 2 
		}
		Curve {
			legend " N3S "
			origin "Trio_U"
			file exp.dat
			columns 1 2
			Style points
			TypePoints 1 
		}
		Curve {
			legend " Braza "
			origin "Trio_U"
			file exp.dat
			columns 1 3
			Style points
			TypePoints 2 
		}
	}
}
#
Conclusion {
	Description " The computation of this test with TrioCFD is satisfactory with a good agreement between calculated results with others numerical results by Chabard $[1]$ and experimental results described by Braza $[2]$. "
	Description " The calculation ends normally without any particular numerical troubles. "
	Description " This simulation enables the validation of laminar calculations with Trio-CFD of an oscillating flow behind a cylinder with isothermal fluid and VEF grids. "

}
