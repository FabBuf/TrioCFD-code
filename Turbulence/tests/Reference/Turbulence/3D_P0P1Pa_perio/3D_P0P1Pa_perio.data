# Thermohydraulique 3D #
# PARALLEL NOT #
dimension 3
Pb_hydraulique pb
Domaine dom

# BEGIN MESH #
Mailler dom
{
	Pave canal
		{
		Origine 0. 0. 0.
		Longueurs 0.25 2 0.25
		Nombre_de_Noeuds 3 8 3
		}
		{
		Bord fond      Y = 2.       0. <= X <= 0.25    0. <= Z <= 0.25
		Bord periox    X = 0.       0. <= Y <= 2.     0. <= Z <= 0.25
		Bord periox    X = 0.25      0. <= Y <= 2.     0. <= Z <= 0.25
		Bord devant    Y = 0.       0. <= X <= 0.25    0. <= Z <= 0.25
		Bord perioz    Z = 0.       0. <= X <= 0.25    0 <= Y <= 2.
		Bord perioz    Z = 0.25      0. <= X <= 0.25    0 <= Y <= 2.
		} 

}
Tetraedriser_homogene_compact dom
Corriger_frontiere_periodique { Domaine dom Bord periox }
Corriger_frontiere_periodique { Domaine dom Bord perioz }
# END MESH #

# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #

VEFPreP1B dis
Read dis { P0 P1 Pa cl_pression_sommet_faible 1 }

Scheme_euler_implicit sch
Read sch
{
	nb_pas_dt_max 5
	tinit 0
	tmax  800.
	dt_min 1.e-5
	dt_max 100.
	dt_impr 10.
	dt_sauv 100.
	seuil_statio 1.e-8
 	Solveur
           Implicite
           {
                seuil_convergence_solveur 1.e-12
           }
	facsec 5.
	facsec_max 500.
}

Fluide_Incompressible air
Read air
{
	mu Champ_Fonc_xyz dom 1 8.e-4
	rho Champ_Uniforme 1 2.
}

Champ_Uniforme gravite
Read gravite 3 0. 0. 0.
Associate air gravite


Associate pb dom
Associate pb sch
Associate pb air

Discretize pb dis

Read pb
{
	Navier_Stokes_standard 
	{ 	
		solveur_pression petsc cholesky { }
		sources {  Canal_perio { bord periox } 
			}
					
		convection { EF_stab { } }
		diffusion { }
		initial_conditions 
				{
			 	vitesse Champ_Uniforme 3 0.1 0. 0.
				}
		boundary_conditions 
				{ 	
				fond  paroi_fixe 
				devant  paroi_fixe
				periox periodique 
				perioz periodique 			
				}
		traitement_particulier { Canal { dt_impr_moy_spat 390. } }
}		
		
Post_processing
	{
		Probes
		{
			sonde_mil vitesse periode 100 segment 14 0.11 0. 0.07 0.11 2. 0.07 
			sonde_entre vitesse periode 100 segment 14 0.115 0. 0.075 0.115 2. 0.075 
			sonde_point vitesse periode 10 point 1 0.115 1. 0.075
		}	
		fields dt_post 500
		{
			vitesse elem
                 }
	}

}
Solve pb
End

