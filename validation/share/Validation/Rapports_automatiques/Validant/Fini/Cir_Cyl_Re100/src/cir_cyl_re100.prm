Parameters {
	Title "Cir Cyl Re100"
	Description "Oscillating flow behind a circular cylinder perpendicular to the flow. "

	VersionTrio_U "1.6.1"

	ParametersTrio_U Type of problem: 2D laminar hydraulic_problem
	ParametersTrio_U Discretization: VEFPreP1B
	ParametersTrio_U Time scheme: Euler Explicite for VDF and VEF
	ParametersTrio_U Momentum convection scheme: EF_stab with alpha = 0.2 or Muscl
	ParametersTrio_U Solving of equations: Navier_Stokes_standard

#
	Reference " $[1]$ Chabard J.P, Lalanne P., Metivet B., Projet N3S de Mecanique des fluides. Cahier de Validation 2D. EDF/DER HE-41/88.08 1988. "
	Reference " $[2]$ Braza P., Chassaing P., H. Ha Minh, Numerical study and physical analysis of pressure and velocity fields in the near wake of a circular cylinder. J. Fluid Mech. 165, 79-130, 1986 " 

	TestCase EI/Muscl test \*
	TestCase EI/EF_stab02 test
	
	Author "E. MOREAU (S. VANDROUX)"
	IncludeData 2
}
Chapter {
	Title "Tests Description"
#
	Description "Hydraulic initial conditions: quiescent fluid U = V = 0 m/s "
	Description "Hydraulic boundary condition: "
	Description " $\bullet$ The velocity is fixed in order to obtain U = 0.03937m/s in such a kind that Re = Ud/$\nu$ = 100 "
	Description " $\bullet$ CERCLE paroi_fixe "
	Description " $\bullet$ PAROI1 symetrie "
	Description " $\bullet$ PAROI2 symetrie "
	Description " $\bullet$ SORTIE frontiere_ouverte_pression_imposee Champ_Front_Uniforme 1 0.0 "
	Description " $\bullet$ SORTIE frontiere_ouverte_vitesse_imposee Champ_Front_Uniforme 2 0.03937 0.0 "
	Description " "
	Description " \latex_(\underline{Validated model:}\latex_)
	Description " - No-slip at the wall "
	Description " - 2D channel "
	Description " - Disturbance of a laminar flow "
	Description " "
	Description " \latex_(\underline{Validation with:}\latex_) Calculations N3S of Chabard $[1]$ and experiments of Braza et al. $[2]$
#
	Figure {
		Title "Geometry"
		Description "In the follwing scheme, L = 0.635m ; W = 0.1524m and d = 0.0254m "
		Width 14cm
		picture geometry.png 
##
	}
	visu {
		Title "Mesh overview"
		Description " Mesh build with Gmsh: 9668 elements "
		Width 14cm, viewport= 0 0 1000 550,clip
		mesh EI/Muscl/test.lata dom
	}
	visu {
		Title "Zoom of the vicinity of the cylinder"
		Description " Triangle layer with 200 points around the circle "
		Width 10cm, viewport= 0 0 1000 1000,clip
		mesh EI/Muscl/test.lata dom
		zoom2D 0.1133 0.141 0.0625 0.09
	}
# properties Geometry
	Table {
			Title "Physical properties"
			Description " "
			nb_columns 1
			label Value
			line {
			      	legend " $\rho$ (kg/$m^3$) "
				file propertiesGeometry.dat	
				nb_columns_file 3
				columns ($1)
			}
			line {
			      	legend " $\mu$ (N/$m^2$/s) "
				file propertiesGeometry.dat	
				nb_columns_file 3
				columns ($2)
			}
			line {
			      	legend " Re "
				file propertiesGeometry.dat	
				nb_columns_file 3
				columns ($3)
			}
	}
#
}
####
####

Chapter {
	Title "Results"

	Description " The temporal pressure course at two probes located on the cylinder surface (y = -0.5d and  y = +0.5d) is shown in the following figure for each convection scheme. The simulations have been perfomed up to 90s of physical time in order to get sufficient cycles allowing the calculation of a frequency. "
####
#### Visu
####
visu {
	Title "Velocity fields at t = 90s "
	Description " We can see behind the cylinder the development of the Von karman vortices. "
	Width 14cm, viewport= 0 0 1000 500,clip
	Vector EI/Muscl/test.lata dom VITESSE ELEM 0.2
	cycles -1
      }
visu {
	Title "Velocity fields at t = 90s "
	Description " We can see behind the cylinder the development of the Von karman vortices. "
	Width 14cm, viewport= 0 0 1000 500,clip
	Pseudocolor EI/Muscl/test.lata dom PRESSION_PA ELEM
	cycles -1
      }

######## 
######## pressure oscillations time from 0 up to 90s
#
	Figure {
		Title " Pressure course at the cylinder surface at y = \latex_($\pm$\latex_)0.5d with a Muscl convection scheme "
		Description " It can be seen that the time of stabilization of the oscillations is of about 40s. From this instant, an oscillation frequency can be determined. " 
		Description "$$\ $$ "
		Width 10cm
		Dimension 2

		LabelX " time (s)"
		RangeX 0 90
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
#
	Figure {
		Title " Pressure course at the cylinder surface at y = \latex_($\pm$\latex_)0.5d with an EF_stab (alpha = 0.2) convection scheme "
		Width 10cm
		Dimension 2

		LabelX " time (s)"
		RangeX 0 90
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
#
#pressure oscillations time from 40 up to 50s
#
	Figure {
		Title " Zoom of the pressure course at the cylinder surface (Muscl) "
		Description " Oscillations are well established in this time range "
		Width 10cm
		Dimension 2

		LabelX " time (s)"
		RangeX 40 50
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/Muscl/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
#
	Figure {
		Title " Zoom of the pressure course at the cylinder surface (EF_stab with alpha = 0.2) "
		Width 10cm
		Dimension 2

		LabelX " time (s)"
		RangeX 40 50
		LabelY "Pressure (Pa)"
		RangeY -0.0015 -0.0005
		Include_Description_Curves 0
		Curve {
			legend "y = +0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 4
			Style lines
			TypeLigne 1
		}
		Curve {
			legend "y = -0.5d"
			origin "Trio_U"
			file EI/EF_stab02/test_SONDE_PRESSION.son
			columns 1 5
			Style lines
			TypeLigne 2 
		}
	}
####
#### Strouhal number
####
	Table {
			Title " Comparison of Strouhal numbers "
			Description " The temporal pressure course in the media allows the determination of the Strouhal number \latex_($S_{t}$\latex_) defined as \latex_($S_{t}=\frac{f.d}{U}$\latex_), where $f$ stands for the vortices emission frequency, $U$ the undisturbed velocity (in our case the inlet velocity), and $d$ the cylinder diameter. We can in this way compare the simulation values with those of Tritton and Roshko collected by Chabard $[1]$ "
			nb_columns 4
			label Frequency (Hz)| Stroual Number| Error % (Tritton)| Error % (Roshko)
			line {
			      	legend " Tritton "
				values 0.243 0.157 0 6
			}
			line {
			      	legend " Roshko "
				values 0.259 0.167 6 0
			}
			line {
			      	legend " Muscl "
				file ./EI/Muscl/strouhal.dat
				nb_columns_file 4
				last_line
				columns ($1) ($2) ($3) ($4)
			}
			line {
			      	legend " EF_stab (alpha = 0.2) "
				file ./EI/EF_stab02/strouhal.dat
				nb_columns_file 4
				last_line
				columns ($1) ($2) ($3) ($4)
			}
	}
###
### 			
### Mean Pressure
###
	Figure {
		Title " Comparison of the mean pressure distribution along the cylinder surface with different convection and time schemes "
		Description " The distribution of the mean pressure along the cylinder surface (averaged from 40s up to 90s) is shown and compared to values of N3S $[1]$ and Braza $[2]$ " 
#		Width 10cm, viewport= 0 0 1024 400,clip
		Dimension 2
		LabelX " Angle (°)"
		RangeX 180 0
		LabelY "Mean Pressure (Pa)"
		RangeY -0.0015 0.0015
		Include_Description_Curves 0
		Curve {
			legend " Muscl "
			origin "Trio_U"
			Segment EI/Muscl/test.data SONDE_PMOY1
			columns 1 2
			Style lines
			TypeLigne 1 
		}
		Curve {
			legend " EF_stab (alpha = 0.2) "
			origin "Trio_U"
			Segment EI/EF_stab02/test.data SONDE_PMOY1
			columns 1 2
			Style lines
			TypeLigne 2 
		}
		Curve {
			legend " N3S "
			origin "Trio_U"
			file exp.dat
			columns 1 2
			Style points
			TypePoints 1 
		}
		Curve {
			legend " Braza "
			origin "Trio_U"
			file exp.dat
			columns 1 3
			Style points
			TypePoints 2 
		}
	}

#
}
#####
Chapter {
	Title "Conclusion"
	Description " This simulation enables the validation of laminar calculations of an oscillating flow behind a cylinder with isothermal fluid and VEF grids. In this case, the calculated results are in good agreement with those obtained by Chabard $[1]$ et Braza $[2]$. "
}
#####
Chapter {
	Title "Recommendations for users"
	Description " $\bullet$ The Euler implicite scheme is not recommanded because, as the calculation presents oscillations, the value of the facsec coefficient must remain small. The calculation time is then increased instead of being improved. "
	Description " $\bullet$ The pressure variable to be employed in the data file is not 'Pression' but 'Pression_Pa', that gives the pressure in Pa. "
}
#####
Chapter {
	Title "Computer performance"
		tableau_performance {
		}

}




