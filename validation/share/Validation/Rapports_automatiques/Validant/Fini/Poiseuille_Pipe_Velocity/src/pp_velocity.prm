Parameters {
	Title " Poiseuille_3D_pipe_velocity "
#
	Description " Poiseuille flow in a cylindrical pipe " 
#
	VersionTrio_U "1.6.1"
#
	ParametersTrio_U Type of problem: 3D hydraulic 
	ParametersTrio_U Time scheme: Euler_Implicite
	ParametersTrio_U Momentum convection scheme: Amont, muscl, Negligeable, EF_stab with alpha = 0.2
	ParametersTrio_U Discretization: VEFP1B
	ParametersTrio_U Turbulence model: None
	ParametersTrio_U Inlet boundary condition: parabolic profile of velocity
 	ParametersTrio_U Outlet boundary condition: Free outlet
	ParametersTrio_U Type of fluid: pure numerical properties  
	ParametersTrio_U Solving of equation: Navier Stokes equation with different convection schemes
#
	TestCase Amont test \* 
 	TestCase Muscl test
	TestCase Negligeable test
	TestCase EF_stab02 test
#
	Author "E.MOREAU (V.BARTHEL)"
	IncludeData 2

}
##################################################
###
### test 1
###
Chapter {
	Title "Description of the tests"
#
	Description " $\bullet$ 3D hydraulic problem "
	Description " $\bullet$ Dimension: cylinder of radius $r$ = 1m and of height $L$ = 20 m "
	Description " $\bullet$ Type of mesh elements: tetrahedrical "
	Description " $\bullet$ Type of cells: unstructured volumes generated by GMSH "
	Description " $\bullet$ Hydraulic Initial conditions: Velocity in $z$ direction of 0.5m/s "
	Description " $\bullet$ Inlet boundary condition: parabolic profile of velocity such as \latex_($V_{z} = 1-(x^{2}+y^{2})$\latex_) m/s"
	Description " $\bullet$ Outlet boundary condition: imposed pressure of 0 Pa "
	Description " $\bullet$ Wall boundary condition: fixed wall "
	Description " "
	Description " \latex_(\underline{Validation with:}\latex_) Analytical solution "
#
	Figure {
		Title " General overview of the test "
		Width 12cm
		picture geometry.png
	}
	visu {
		Title "Mesh visualization: view of the outlet "
		Description " The mesh have been build with three prism layers near the wall, that have been then cut into tetrahedrical cells with GMSH "
		Description " Number of elements: 126560 "
		Width 10cm, viewport= 0 0 824 724,clip
		mesh Amont/test.lata dom
		normal3D -0.020433 0.129418 0.99138
		up3D -0.0416893 0.990614 -0.130177
		zoom3D 0. 0. 1.55
		operator no_bounding_box
		operator no_axes
	}
	visu {
		Title "Mesh visualization: lateral view "
		Width 10cm, viewport= 0 0 1024 1024,clip
		mesh Amont/test.lata dom
		normal3D 0.427936 0.108239 0.897304
		up3D -0.215804 0.976324 -0.0148513
		zoom3D 0.028 0.0530019 1.37416
		operator no_bounding_box
		operator no_axes
	}
#
# properties Geometry
	Table {
			Title "Physical properties "
			Description " "
			nb_columns 1
			label Value
			line {
			      	legend " $\rho$ (kg/$m^3$) "
				file propertiesGeometry.dat	
				nb_columns_file 2
				columns ($1)
			}
			line {
			      	legend " $\mu$ (N/$m^2$/s) "
				file propertiesGeometry.dat	
				nb_columns_file 2
				columns ($2)
			}
	}
#
}
#####
#####
Chapter {
	Title " Results for the pressure"
#
	Description " The analytical solution in a cylindrical pipe for a laminar and imcompressible flow may be expressed as:"
	Description " \latex_($$ \Delta P = \frac{-8\mu Q_{\textrm{v}} L}{\pi R^{4}}\ \Leftrightarrow\ \frac{\textrm{d}P}{\textrm{d}z} = \frac{ -8\mu U_{\textrm{moy}} }{R^{2}} \approx -0.08 $$\latex_) "
	Description " Hence, the analytical expression of the pressure will be: $P(z) = -0.08(z-L)$ "
	Description " It is then convenient to use the quantity $P(z)/\rho$ since it is directly post-processed in the data file. We will have in this case  \latex_($\frac{P(z)}{\rho} = -0.044(z-L)$ \latex_) "
	Figure {
		Title " Pressure profile (Convection scheme influence) "
		Description " The following curves represent the quantity Pressure/density as a function of $z$ "
		Width 10cm
		Dimension 2
		LabelX " z (m)"
		RangeX 0 20.
		LabelY " Pressure/density (m2/s2) "
		RangeY 0 1
		Include_Description_Curves 0
		Curve {
			legend " Analytic curve "
			origin "Trio_U"
			Fonction -0.08*(x-20)/1.8
			Style points
			TypePoints 10 
		}
		Curve {
			legend " Amont "
			origin "Trio_U"
			Segment Amont/test.data sonde_P_IN_OUT
			columns 1 2
			Style lines
			TypeLigne 1 
		}
		Curve {
			legend " Muscl "
			origin "Trio_U"
			Segment Muscl/test.data sonde_P_IN_OUT
			columns 1 2
			Style points
			TypePoints 2 
		}
		Curve {
			legend " Negligeable "
			origin "Trio_U"
			Segment Negligeable/test.data sonde_P_IN_OUT
			columns 1 2
			Style points
			TypePoints 3 
		}

		Curve {
			legend " EF_stab (alpha = 0.2) "
			origin "Trio_U"
			Segment EF_stab02/test.data sonde_P_IN_OUT
			columns 1 2
			Style points
			TypePoints 4
		}
	}
#
}
#################
#####
#####
Chapter {
	Title " Results of the friction velocity \latex_($u_{\tau}$\latex_) "
#
	Description " In this section we compare the theoretical and simulated friction velocities. The theoretical velocity is calculated from the following relation, where $DH$ stands for the hydraulic diameter: "
	Description " $$\latex_( u_{\tau} = \sqrt{\frac{1}{\rho}\frac{\Delta p}{\Delta z}.\frac{DH}{4}} \latex_)$$ "
	Description " The simulated velocity is determined from the wall viscous forces $\latex_(\tau_{w}\latex_)$ from the relation $\latex_( \tau_{w} = \rho.u^{2}_{\tau}.S_{w} \latex_)$, where $\latex_(S_{w}\latex_)$ is the total wall surface. "
	Table {
			Title " Friction velocities at time t = 30s "
			Description " "
			nb_columns 3
			label Theoretical velocity (m/s) | Trio_U velocity (m/s) | Error (%)
			line {
			      	legend " Amont "
				file Amont/calculF.dat	
				columns ($1) ($2) ($3)
			}
			line {
			      	legend " Muscl "
				file Muscl/calculF.dat	
				columns ($1) ($2) ($3) 
			}
			line {
			      	legend " Negligeable "
				file Negligeable/calculF.dat	
				columns ($1) ($2) ($3)
			}
			line {
			      	legend " EF_stab (alpha = 0.2) "
				file EF_stab02/calculF.dat	
				columns ($1) ($2) ($3)
			}
	}
#
}
#####
Chapter {
	Title "Comments and Conclusion"
	Description " The three momentum convection schemes (Muscl, EF_stab and Amont) give results very close to the theoretical solution. Moreover, althought the Amont scheme is in good agreement with the analytical solution, it gives the less good results among the four schemes"

}
#####
Chapter {
	Title "Recommendations for users"
	Description " It is recommended to use a either Muscl or EF_stab when convection is needed for this type of forced convection flow "
}
###

Chapter {
	Title "Computer performance"
		tableau_performance {
		}
}



