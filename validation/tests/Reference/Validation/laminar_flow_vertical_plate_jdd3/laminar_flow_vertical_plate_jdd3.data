# ThermoHydraulique 2D #
# PARALLEL NOT #
dimension 2
option_VDF { traitement_coins oui }
Pb_Thermohydraulique_QC pb
Domaine dom
# BEGIN MESH #
Mailler dom 
{
        Pave Entree
                {
                Origine  0. 0. 
                Nombre_de_Noeuds 61  81
                Facteurs  1.05 1. Symy
                Longueurs 0.3 1.
                }
                {

                bord Gauche         X = 0.     0. <= Y <= 1.
                bord Droite         X = .3     0. <= Y <= 1.
                bord Bas            Y = 0.     0. <= X <= 3.e-1  
                bord Haut           Y = 1.     0. <= X <= 3.e-1  
 

                }
}

# END MESH #

VDF dis

Schema_Euler_explicite sch
Read sch
{
        tinit 0.
	nb_pas_dt_max 3
        tmax  8.
        dt_min 1.e-9
        dt_max 1.e-2
        dt_impr 5.e-1
        dt_sauv 10.
        seuil_statio 1.e-8
	facsec 1.
}

Fluide_Quasi_compressible fluide
Read fluide
{	pression   1.e5
	mu Champ_Uniforme     1 2.9e-5
	loi_etat gaz_parfait
	{ 
	Prandtl 1.
	Cp  1006.4
	gamma 1.53411
	}
	Traitement_Pth constant
	Traitement_Rho_gravite moins_rho_moyen
}

# 
Rho = 1.
grashoff= g*betha*dT*L^3*Rho^2/mu^2 = 10^9 
pour un gaz parfait betha = 1/T donc ici betha =3.5.e-3
Pr= mu*Cp/lambda = 1 
lambda = 0.0292 
#


Champ_Uniforme gravite
Read gravite 2 0. -9.81

Associate fluide gravite
Associate pb dom
Associate pb sch
Associate pb fluide

Discretize pb dis

Read pb
{
        Navier_Stokes_QC
        {
                solveur_pression Cholesky { }        
                convection { amont }
                diffusion { }
                conditions_initiales {
                         vitesse Champ_Uniforme 2 0. 0.
                        }
                boundary_conditions {
                        Gauche  paroi_fixe
                        Droite  symetrie
                        Bas     frontiere_ouverte_vitesse_imposee champ_front_uniforme 2 0. 0.
                        Haut    frontiere_ouverte_Pression_imposee Champ_Front_Uniforme 1 0.

          }
        }
        Convection_Diffusion_Chaleur_QC
        {
                diffusion { }
                convection { amont }
                boundary_conditions 
                {
			Bas     Frontiere_ouverte_Temperature_imposee Champ_Front_Uniforme 1 273.15  
                        Haut    frontiere_ouverte T_ext Champ_Front_Uniforme 1 273.15
			Gauche  paroi_echange_externe_impose T_ext Champ_Front_Uniforme 1  297.65  H_imp Champ_Front_Uniforme 1  1.e11  
 			Droite  symetrie


                }
                conditions_initiales { Temperature Champ_Uniforme 1 273.15 }
        }


	
        Postraitement
        {
		Format lml
		Champs dt_post 1.e2

			{

			temperature elem
			vitesse elem
			}
	        Sondes
	          	{
			coupe_vitx0  vitesse periode 1.e-5 segment 40        0.0004 0.   0.004 1.  
			coupe_tempx0 temperature  periode 1.e-5 segment 40   0.004 0.   0.004 1.
			
                        coupe_vitx  vitesse periode 1.e-5 segment 40        0.006 0.   0.006 1.  
			coupe_tempx temperature  periode 1.e-5 segment 40   0.009 0.   0.009 1.


			coupe_vit9  vitesse periode 1.e-5 segment      40   0. 0.91 0.2 0.91  
			coupe_temp9 temperature  periode 1.e-5 segment 40   0. 0.91 0.2 0.91
                       
			coupe_vit7   vitesse periode 1.e-5 segment 40        0. 0.71  0.2  0.71 
			coupe_temp7  temperature  periode 1.e-5 segment 40   0. 0.71  0.2  0.71 
 			
			coupe_temp8  temperature  periode 1.e-5 segment 40   0.	0.81  0.2  0.81
	        	coupe_vit8   vitesse periode 1.e-5 segment 40        0.	0.81  0.2  0.81 
		}

}

}
Imprimer_flux dom { Gauche  }
Solve pb
End
