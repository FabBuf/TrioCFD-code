# Thermohydraulique 2D avec modele K-Epsilon a deux couches #
# PARALLEL OK #

dimension 2
Pb_Thermohydraulique_Turbulent pb
Domaine dom
# BEGIN MESH #
Mailler dom
{
	Pave Cavite1 
		{
		Origine 0. 0.
     		Longueurs 0.5 2.5
     		Nombre_de_Noeuds 26 26
		Facteurs 1.2 1.2 SymX SymY
		}
		{
		Bord plaq_bas      Y = 0.    0. <= X <= 0.5
		Bord plaq_gauche    X = 0.       0. <= Y <= 2.5
		Bord plaq_haut     Y = 2.5       0. <= X <= 0.5
		Bord plaq_droit    X = 0.5       0. <= Y <= 2.5
		} 
}
# END MESH #
# BEGIN PARTITION
Partition dom
{
	Partitionneur tranche { tranches 2 1 }
	Larg_joint 1
	Nom_Zones DOM
}
Fin
END PARTITION #

# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #

Schema_Euler_explicite sch
Lire sch
{
	tinit 0.
	tmax 2.
	dt_min 1.e-15
	dt_max 0.01    
	dt_impr 1.e-1
	dt_sauv 30.
	seuil_statio 1.e-15
	facsec 0.8
}

Fluide_Incompressible air
Lire air
{
	mu Champ_Uniforme 1 1.906e-5
	rho Champ_Uniforme 1 1.124
	lambda Champ_Uniforme 1 0.0271 
	Cp Champ_Uniforme 1 1006.8
	beta_th Champ_Uniforme 1 3.23e-3
}

Champ_Uniforme gravite
Lire gravite 2 0 -9.81

#
 associations d'objets au probleme et
 schema de discretisation spatiale 
#
Associate air gravite
Associate pb dom
Associate pb sch
Associate pb air

VDF dis
Discretize pb dis

Lire pb
{
	Navier_Stokes_turbulent 
	{
	 	dt_projection 20 1.e-10
		solveur_pression Cholesky { }
		convection { Amont }
		diffusion { }
		sources { boussinesq_temperature { T0 20. } }
		conditions_initiales {
			 	vitesse Champ_Uniforme 2 0. 0. }
		boundary_conditions { 	
				plaq_bas  paroi_fixe 
				plaq_gauche  paroi_fixe
				plaq_droit  paroi_fixe
				plaq_haut  paroi_fixe
				}
		modele_turbulence K_Epsilon_2_couches { 
			Transport_K_KEpsilon
			{      
       				nb_couches 10 
				impr
				convection { amont }
				diffusion { }
				boundary_conditions {
					plaq_bas   paroi 
					plaq_haut   paroi
					plaq_gauche  paroi
					plaq_droit  paroi
		      			}
			   	conditions_initiales { k_eps Champ_Uniforme 2 1.e-3 1.e-3 }
			}
                          turbulence_paroi loi_paroi_2_couches dt_impr_ustar 10
		} 
	}

        Convection_Diffusion_Temperature_Turbulent {
                diffusion { }
                convection { amont }
                boundary_conditions {
			plaq_bas   paroi_adiabatique 
			plaq_haut   paroi_adiabatique
 			plaq_droit   paroi_temperature_imposee  Champ_Front_Uniforme 1 20. 
 			plaq_gauche   paroi_temperature_imposee  Champ_Front_Uniforme 1 65.8

		}
		conditions_initiales { Temperature Champ_Uniforme 1 20. }
                Modele_Turbulence Prandtl { Turbulence_paroi loi_paroi_2_couches_scalaire }
 		}


Postraitement
	{
		Sondes
		{	sonde_vit1 vitesse periode 0.2 segment 51 0.0 0. 0.5 0. 
                        sonde_vit2 vitesse periode 0.2 segment 51 0.0 0.5 0.5 0.5 
                        sonde_vit3 vitesse periode 0.2 segment 51 0.0 1.25 0.5 1.25 
                        sonde_vit4 vitesse periode 0.2 segment 51 0.0 2. 0.5 2. 
                        sonde_vit5 vitesse periode 0.2 segment 51 0.0 2.5  0.5 2.5 
                        sonde_vit6 vitesse periode 0.2 segment 51 0.0 1.5  0.5 1.5 
                        sonde_temp1 temperature periode 0.2 segment 51 0.0 0 0.5 0 
                        sonde_temp2 temperature periode 0.2 segment 51 0.0 0.5 0.5 0.5 
                        sonde_temp3 temperature periode 0.2 segment 51 0.0 1.25 0.5 1.25 
                        sonde_temp4 temperature periode 0.2 segment 51 0.0 2. 0.5 2. 
                        sonde_temp5 temperature periode 0.2 segment 51 0.0 2.5  0.5 2.5 
                        sonde_temp6 temperature periode 0.1 segment 51 0.0 1.5  0.5 1.5 
                        
			sonde_temp7 temperature periode 0.2 segment 51 0.25 0.  0.25 2.5 
    			sonde_vit7 vitesse periode 0.2 segment 51 0.25 0.  0.25 2.5 
			sonde_temp8 temperature periode 0.2 segment 51 0.01 0.  0.01 2.5 

                        sonde_vitesse vitesse periode 0.2 points 5  0.01 2.  0.03 2.  0.05 2.  0.07 2.  0.10 2. 
			sonde_temper temperature periode 0.2 points 5  0.01 2.  0.03 2.  0.05 2.  0.07 2.  0.10 2.
			sonde_nut viscosite_turbulente periode 0.2 points 5  0.01 2.  0.03 2.  0.05 2.  0.07 2.  0.10 2.
			sonde_k k periode 0.2 points 5  0.01 2.  0.03 2.  0.05 2.  0.07 2.  0.10 2.
               		sonde_eps eps periode 0.2 points 5  0.01 2.  0.03 2.  0.05 2.  0.07 2.  0.10 2.
		}	
		Champs dt_post 20
		{
			vitesse elem
			vitesse som
			temperature elem
			temperature som
			k elem
                        k som
                        eps elem
                        eps som
                        viscosite_turbulente elem
                        viscosite_turbulente som
		}
	}
}
Imprimer_flux dom { plaq_gauche }
Solve pb
Fin

