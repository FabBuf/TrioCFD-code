# Thermohydraulique 2D avec modele Bas Reynolds pour les fluctuations thermiques #
# PARALLEL OK 4 #

dimension 2
Pb_Thermohydraulique_Turbulent pb
Domaine dom
# BEGIN MESH #
Mailler dom
{
	Pave Cavite 
		{
		Origine 0. 0.
     		Longueurs 1. 4.
     		Nombre_de_Noeuds 26 21
		Facteurs 1. 1.0 
		}
		{
		Bord plaq_chauf    X = 0.       0.  <= Y <= 3.9
		Bord plaq_haut     X = 0.       3.9 <= Y <= 4.
		Bord plafond       Y = 4.       0.  <= X <= 1.
		Bord loin          X = 1.       0   <= Y <= 4.
		Bord plancher      Y = 0.       0.  <= X <= 1.0
		}
}
# END MESH #

# BEGIN PARTITION
Partition dom
{
	Partitionneur tranche { tranches 2 1 }
	Larg_joint 1
	Nom_Zones DOM
}
End
END PARTITION #

# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #

Schema_Euler_explicite sch
Read sch
{
	nb_pas_dt_max 10
	tinit 0.
	tmax  10.
	dt_min 0.01
	dt_max 0.01
	dt_impr 1
	dt_sauv 10.
	seuil_statio 1.e-10
}

Fluide_Incompressible air
Read air
{
	mu Champ_Uniforme 1 1.906e-5
	rho Champ_Uniforme 1 1.124
	lambda Champ_Uniforme 1 0.0271 
	Cp Champ_Uniforme 1 1.0068
	beta_th Champ_Uniforme 1 3.23e-3
}

Champ_Uniforme gravite
Read gravite 2 0 -9.81

#
 associations d'objets au probleme et
 schema de discretisation spatiale 
#
Associate air gravite
Associate pb dom
Associate pb sch
Associate pb air

VDF dis
Discretize pb dis

Read pb
{
	Navier_Stokes_turbulent 
	{ 	solveur_pression GCP { precond ssor { omega 1.5 } seuil 1.e-15 }	
		convection { Amont }
		diffusion { }
		sources { boussinesq_temperature { T0 16. } }
		conditions_initiales {
			 	vitesse Champ_Uniforme 2 0. 0. }
		boundary_conditions { 	
				plaq_chauf  paroi_fixe
				plaq_haut  paroi_fixe
				loin      Frontiere_ouverte_pression_imposee 										Champ_front_uniforme 1 0.
				plancher    Frontiere_ouverte_pression_imposee 										Champ_front_uniforme 1 0. 
				plafond  Frontiere_ouverte_gradient_pression_impose 									Champ_front_uniforme 1 0.
				}
		modele_turbulence K_Epsilon_Bas_Reynolds { 
       			Transport_K_Epsilon_Bas_Reynolds 
			{      
				convection { amont }
				diffusion { }
				boundary_conditions {
					plaq_chauf   paroi_fixe
					plaq_haut   paroi_fixe
		       			loin frontiere_ouverte k_eps_ext 
		       				Champ_Front_Uniforme 2 1.e-3 1.e-3
		       			plancher frontiere_ouverte k_eps_ext 
		       				Champ_Front_Uniforme 2 0. 0.
		       			plafond frontiere_ouverte k_eps_ext 
		       				Champ_Front_Uniforme 2 0. 0.
		      			}
			   	conditions_initiales { k_eps Champ_Uniforme 2 1.e-3 1.e-3 }
			}
			Modele_Fonc_Bas_Reynolds Jones_Launder { }
			Turbulence_paroi negligeable
		} 
	}
	Convection_Diffusion_Temperature_Turbulent
	{
		diffusion { }
		convection { amont }
		boundary_conditions 
		{
			
			plaq_haut   paroi_adiabatique
 			plaq_chauf   paroi_temperature_imposee Champ_Front_Uniforme 1 60. 
			loin       Frontiere_ouverte T_ext Champ_Front_Uniforme 1 16. 
			plancher     Frontiere_ouverte T_ext Champ_Front_Uniforme 1 16. 
			plafond   Frontiere_ouverte T_ext Champ_Front_Uniforme 1 16. 
		}
		conditions_initiales { Temperature Champ_Uniforme 1 16. }
		modele_turbulence Fluctuation_Temperature_W_Bas_Re {
                        Transport_Fluctuation_Temperature_W_Bas_Re
                        {
                                diffusion { }
                                convection { amont }
                                boundary_conditions {
					plaq_chauf  Paroi_fixe
					plaq_haut  Paroi_fixe
                                        loin      Frontiere_ouverte_Fluctu_Temperature_imposee Champ_Front_Uniforme 2  0.1 0.1
                                        plancher    Frontiere_ouverte Fluctu_Temperature_ext Champ_Front_Uniforme 2 0. 0.
                                        plafond  Frontiere_ouverte Fluctu_Temperature_ext Champ_Front_Uniforme 2 0. 0.
                                }
                                conditions_initiales {
                                        Fluctu_Temperature Champ_Uniforme 2 1 1
                                }
                         }
			Modele_Fonc_Bas_Reynolds_Thermique Jones_Launder { }
			Turbulence_paroi negligeable_scalaire
	}
}
Postraitement
	{
		Sondes
		{
			sonde_k1    k periode 10 segment 21 0.0 1.428 0.2 1.428
                        sonde_k2    k periode 10 segment 21 0.0 1.918 0.2 1.918 
                        sonde_k3    k periode 10 segment 21 0.0 2.535 0.2 2.535 
			sonde_eps1    eps periode 10 segment 21 0.0 1.428 0.2 1.428
                        sonde_eps2    eps periode 10 segment 21 0.0 1.918 0.2 1.918 
                        sonde_eps3    eps periode 10 segment 21 0.0 2.535 0.2 2.535 

			sonde_vit1 vitesse periode 10 segment 70 0.0 1. 1. 1. 
                        sonde_vit2 vitesse periode 10 segment 70 0.0 2 1. 2. 
                        sonde_vit3 vitesse periode 10 segment 70 0.0 2.54 1. 2.54 
                        sonde_temp1 temperature periode 10 segment 70 0.0 1. 1. 1. 
                        sonde_temp2 temperature periode 10 segment 70 0.0 2. 1. 2. 
                        sonde_temp3 temperature periode 10 segment 70 0.0 2.54 1. 2.54 

                        sonde_temp4 temperature periode 1 segment 80 0.01 0. 0.01 4 


                        sonde_vitesse vitesse periode 10 points 5  0.01 3.94  0.03 3.94  0.05 3.94  0.07 3.94  0.10 3.94 
			sonde_temper temperature periode 10 points 5  0.01 3.94  0.03 3.94  0.05 3.94  0.07 3.94  0.10 3.94
			sonde_nut viscosite_turbulente periode 10 points 5  0.01 3.94  0.03 3.94  0.05 3.94  0.07 3.94  0.10 3.94
			sonde_k k periode 10 points 5  0.01 3.94  0.03 3.94  0.05 3.94  0.07 3.94  0.10 3.94
               		sonde_eps eps periode 10 points 5  0.01 3.94  0.03 3.94  0.05 3.94  0.07 3.94  0.10 3.94
		}	
		Champs dt_post 20.
		{
			vitesse elem
			temperature elem
			k elem
                        eps elem
                        viscosite_turbulente elem
		}
	}

}
Solve pb
End

