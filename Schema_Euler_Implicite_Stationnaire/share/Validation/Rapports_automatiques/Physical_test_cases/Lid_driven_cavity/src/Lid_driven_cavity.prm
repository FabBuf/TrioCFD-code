Parameters {
	Title "2D Lid driven cavity test"

        Author "mp250145"
	VersionTrio_U 1.7.3 

        Description Test of the new Time scheme with Solveur implicit_steady using a dual time step for the steady problems
        Description The time scheme Implicit_Euler_steady_scheme can be seen as a modification of the Euler_Implicit (with Solveur implicit) time scheme in which the time step varies in the domain
	Description The idea is here to compare the solution obtained with these two time schemes
        Description Here after the "reference solution TrioCFD" is the solution obtained with the "Euler_Implicit (with Solveur implicit)"  time scheme
        Description We also compared these two TrioCFD solutions with the Fluent solution and with the solutions given in references 1 and 2.


        IncludeData 1
        Reference "1. U. Ghia, and K. N. Ghia, and C. Shin, 'High-Re solutions for incompressible flow using the Navier-Stokes equations and a multigrid method', Journal of the Brazilian Society of Mechanical Sciences and Engineering, 3:387-411, 1982"
        Reference "2. C. H. Marchi,  and R. Suero,  and L. K. Araki, 'The lid-driven square cavity flow: numerical solution with a 1024 x 1024 grid', Journal of the Brazilian Society of Mechanical Sciences and Engineering, 3:186--198, 2009." 

	ParametresTrio_U Type of problem: Steady Navier-Stokes
	ParametresTrio_U Discretizations: VEFPreP1B
	ParametresTrio_U Type of meshes:  Triangles
	ParametresTrio_U Pressure solver: GCP with SSOR preconditioneur
	ParametresTrio_U Time scheme: Implicit_Euler_steady_scheme with Solveur implicit_steady
	ParametresTrio_U Convection scheme: amont


	TestCase Steady defilante.data /*jdd en annexe*/ 
}

Chapter {
	Title "Convergence" 
	figure { 
		title "Evolution of residue"
		include_description_curves 0
		labelX "TIME"
		labelY "residu=max|Ri|"
		logX
		logY
		curve {
			file ./Steady/defilante.dt_ev
			columns ($1) ($4)
			legend "column 4"
			Style linespoints
		}
	}
}

Chapitre {
	Titre "Probes: 1D Plots"

	figure { 
		title "Velocity along line x=0.5"
		include_description_curves 0
		labelX "y"
		labelY "Vx"
		Courbe {
			Legende "Reference 1 velocity"
			Fichier ./Reference/Ref4_x_velocity_vertical.dat
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 5
			TypePoints 1
			PointSize 1
			}
		Courbe {
			Legende "Reference 2 velocity"
			Fichier ./Reference/Ref5_x_velocity_vertical.dat
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 15
			TypePoints 2
			PointSize 1
			}
		Courbe {
			Legende "Fluent velocity"
			Fichier ./Fluent/vx_x_0.5
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 10
			TypePoints 3
			PointSize 0.5
			}
		curve {
			file ./Solution_reference/defilante_SONDE_VITESSE_X_4.coupe
			Legende "Reference velocity solution TrioCFD"
			columns ($1) ($2)
			Style linespoints
			TypeLigne 20
			TypePoints 5
			PointSize 1
		}
		Courbe {
			Legende "Velocity"
                        segment ./Steady/defilante SONDE_VITESSE_X_4
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 1
			TypePoints 7
			PointSize 1
			}

	}

	figure { 
		title "Velocity along line y=0.5"
		include_description_curves 0
		labelX "x"
		labelY "Vy"
		Courbe {
			Legende "Reference 1 velocity"
			Fichier ./Reference/Ref4_y_velocity_horizontal.dat
			Colonnes ($1) ($2)
			Style linespoints
			Style linespoints
			TypeLigne 5
			TypePoints 1
			PointSize 1
			}
		Courbe {
			Legende "Reference 2 velocity"
			Fichier ./Reference/Ref5_y_velocity_horizontal.dat
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 15
			TypePoints 2
			PointSize 1
			}
		Courbe {
			Legende "Fluent velocity"
			Fichier ./Fluent/vy_y_0.5
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 10
			TypePoints 3
			PointSize 0.5
			}
		curve {
			file ./Solution_reference/defilante_SONDE_VITESSE_Y_2.coupe
			Legende "Reference velocity solution TrioCFD"
			columns ($1) ($2)
			Style linespoints
			TypeLigne 20
			TypePoints 5
			PointSize 1
		}
		Courbe {
			Legende "Velocity"
			segment ./Steady/defilante SONDE_VITESSE_Y_2
			Colonnes ($1) ($2)
			Style linespoints
			TypeLigne 1
			TypePoints 7
			PointSize 1
			}


}

}



Chapter {
	Title "Visualization via VisIt" 
	visu {
		title "MESH"
		mesh ./Steady/defilante.lata dom
	}
	visu {
		title "VITESSE_X SOM"
		pseudocolor ./Steady/defilante.lata dom VITESSE_X SOM
	}

}



Chapitre {
	Titre "CPU tables"


	Tableau {
		Titre "CPU table "
		Nb_colonnes 1
		label  nb_iter 
		
		Ligne {
			Legende "New time scheme"
			fichier Steady/CPU_time.dat
			Nb_colonnes_fichier 2
			Colonnes ($1)  
			}
		Ligne {
			Legende "Reference solution"
			fichier Solution_reference/CPU_time.dat
			Nb_colonnes_fichier 2
			Colonnes ($1) 
			}
	}
	
}

Chapitre {
	Titre "Conclusion"
	Description The time scheme 'Implicit_Euler_steady_scheme' reproduces the stationary solution obtain with the time scheme 'Euler_Implicit' while considerably reducing the number of time steps required during the transitory phase. 
Description These solutions are in perfect agreement with the Fluent solution and with the two literary reference solutions.
Description The observed time CPU in seconds for these test case was for the 'Euler_Implicit' scheme equal to 42269, for the 'Implicit_Euler_steady_scheme' scheme equal to 6241, and for the Fluent equal to 5196.
        
}


