\newpage
\rhead{\'ECOULEMENTS DIPHASIQUES}
\chapter{\label{sec:FT}Mod\`ele \`a interface diffuse incompr\'essible}
\lhead{Phase Field}

\section{Pr\'esentation du mod\`ele}
Le mod\`ele \textit{Phase Field} est un mod\`ele \`a interface diffuse d\'edi\'e
\`a la \texttt{simulation num\'erique directe d'\'ecoulements diphasiques
incompressibles de fluides non miscibles}. Dans les mod\`eles \`a interface
diffuse, les interfaces s\'eparant les phases du syst\`eme ne sont pas
mod\'elis\'ees comme des surfaces de discontinuit\'e mais comme des
\texttt{zones volumiques de transition} \`a travers lesquelles toutes les
grandeurs physiques varient de mani\`ere continue. Ces mod\`eles sont bas\'es
sur l'introduction d'un \texttt{param\`etre d'ordre} caract\'eristique des
phases. Dans le mod\`ele pr\'esent\'e ici,  ce param\`etre d'ordre est
repr\'esentatif du \texttt{taux de pr\'esence volumique} de l'une des phases,
que l'on note $\varphi$. Afin de prendre en compte les \texttt{ph\'enom\`enes
capillaires}, importants en simulation num\'erique directe, l'\'energie du
syst\`eme est suppos\'ee d\'ependre de $\varphi$ mais \'egalement de $\nabla
\varphi$ sous la forme suivante :
\begin{equation}
E = W\left(\varphi\right)+\frac{\alpha}{2}\left(\nabla \varphi\right)^2
\end{equation}
o\`u $\alpha$ est appel\'ee \texttt{coefficient de capillarit\'e interne}. La
fonction $W\left(\varphi\right)$ est une fonction double-puit dont la forme la plus
simple est :
\begin{equation}
W\left(\varphi\right)=\beta\varphi^2\left(1-\varphi\right)^2
\end{equation}
o\`u $\beta$ est une constante caract\'eristique du mod\`ele.\newline
Les coefficients $\alpha$ et $\beta$ sont caract\'eristiques de la tension
interfaciale $\sigma$ et de l'\'epaisseur $h$ des interfaces. En effet, on a les
relations suivantes :
\begin{equation}
\sigma=\frac{\sqrt{2\alpha\beta}}{6}
\end{equation}
\begin{equation}
h=4\sqrt{\frac{\alpha}{2\beta}}
\end{equation}
La tension interfaciale $\sigma$ est une caract\`eristique des fluides en
pr\'esence et l'\'epaisseur $h$ est en g\'en\'eral choisie \'egale \`a environ 4 ou
5 fois la taille des mailles.\medskip\newline
Par application de second principe de la thermodynamique, on peut montrer que les
\'equations du mouvement sont les suivantes :
\begin{equation}
\frac{d\varphi}{dt}=\nabla\cdot\left[\kappa\left(\varphi\right)\nabla\left(\tilde{\mu}+\frac{d\rho}{d\varphi}
\frac{u^2}{2}\right)\right]\label{eq:Cahn-Hilliard}
\end{equation}
\begin{equation}
\rho\left(\varphi\right)\frac{du}{dt}=-\nabla P + \tilde{\mu}\nabla\varphi+\rho\left(\varphi\right)g+\nabla\cdot\tau\label{eq:bilanQDM}
\end{equation}
\begin{equation}
\nabla\cdot u=0\label{eq:GradU}
\end{equation}
o\`u
\begin{equation}
\tilde{\mu}=\frac{dW}{d\varphi}-\nabla\cdot\left(\alpha\nabla\varphi\right)
\end{equation}
est le potentiel chimique g\'en\'eralis\'e et 
\begin{equation}
\rho\left(\varphi\right)=\rho_{1}+\varphi\left(\rho_{2}-\rho_{1}\right)
\end{equation}
est la masse volumique, $\rho_{1}$ et $\rho_{2}$ repr\'esentant la masse volumique des phase correspondant \`a $\varphi=0$ et $\varphi=1$
respectivement.\newline
Dans le syst\`eme pr\'ec\'edent, $d/dt$ repr\'esente la d\'eriv\'e convective, $P$ est la pression et $\tau$ le tenseur des contraintes
visqueuses.\newline
L'\'equation d'\'evolution de $\varphi$ (\'equation \ref{eq:Cahn-Hilliard}) est appel\'ee \texttt{\'equation de Cahn-Hilliard}. Le coefficient
$\kappa$ apparaissant dans cette \'equation est appel\'e \texttt{mobilit\'e} et peut d\'ependre de $\varphi$ de mani\`ere quadratique :
\begin{equation}
\kappa\left(\varphi\right)=a\kappa_{0}\varphi\left(1-\varphi\right)\label{eq:kappa}
\end{equation}
o\`u $a$ et $\kappa_{0}$ sont des constantes.\newline
A noter que le terme $\tilde{\mu}\nabla\varphi$ apparaissant dans l'\'equation de bilan de quantit\'e de mouvement (\'equation \ref{eq:bilanQDM})
repr\'esente les \texttt{forces capillaires}.

\subsection{Changement de variable}
Pour des raisons de simplicit\'e de programmation, l'\'equation de Cahn-Hilliard est consid\'er\'ee comme une \'equation de convection-diffusion
de concentration. Le second memebre de l'\'equation de Cahn-Hilliard (\'equation \ref{eq:Cahn-Hilliard}) est consid\'er\'e comme un terme source,
de m\^eme que le terme en $\tilde{\mu}\nabla\varphi$ de l'\'equation de bilan de quantit\'e de mouvement (\'equation \ref{eq:bilanQDM}).\newline
Pour des raisons de sym\'etrie, la "concentration", \textit{i.e.} l'inconnue de l'\'equation de Cahn-Hilliard, est d\'efinie par :
\begin{equation}
c=\varphi-\frac{1}{2}
\end{equation}
$c$ varie alors de $-1/2$ \`a $+1/2$ \`a la travers\'ee d'une interface. Les relations de fermeture $W\left(\varphi\right)$,
$\rho\left(\varphi\right)$ et $\kappa\left(\varphi\right)$ doivent donc \^etre modifi\'ees en cons\'equence :
\begin{equation}
W\left(\varphi\right)=\beta\left(c-\frac{1}{2}\right)^2\left(c+\frac{1}{2}\right)^2
\end{equation}
\begin{equation}
\rho\left(\varphi\right)=\frac{\rho_{1}+\rho_{2}}{2}+c\left(\rho_{2}-\rho_{1}\right)\label{eq:rhoc}
\end{equation}
\begin{equation}
\kappa\left(\varphi\right)=a\kappa_{0}\left(\frac{1}{2}+c\right)\left(\frac{1}{2}-c\right)
\end{equation}

\subsection{Approximation de Boussinesq}
Le mod\`ele g\'en\'eral peut \^etre d\'egrad\'e en utilisant l'\texttt{approximation de Boussinesq} dans laquelle la masse volumique est
suppos\'ee constante mis \`a part dans le terme de gravit\'e o\`u elle est lin\'earis\'ee. Cette approximation est celle classiquement utilis\'ee
dans \texttt{TrioCFD} et les variables servant\`a la r\'esolution num\'erique du syst\`eme d'\{equations ainsi obtenu sont celles classiquement
utilis\'ees dans \texttt{TrioCFD}. En particulier, la "pression" utilis\'ee pour la r\'esolution coupl\'ee des \'equations de bilan de quantit\'e
de mouvement et de divergence nulle de la vitesse est en fait $(P/\rho_{m}-gz)$, o\`u $\rho_{m}=(\rho_{1} + \rho_{2}/2$ est la masse volumique
moyenne et $z$ la coordonn\'ee verticale (suivant la direction de la gravit\'e). Etant donn\'ee la forme \ref{eq:rhoc} de la fonction $\rho(c)$,
le terme source li\'e \`a la gravit\'e, a l'expression suivante :
\begin{equation}
\frac{\rho_{2}-\rho_{1}}{\rho_{m}} c g
\end{equation}
Cette forme permet de d\'efinir la valeur du param\`etre \texttt{beta\_co} (\textit{i.e.} $(\rho_{2}-\rho_{1})/\rho_{m}$).

\subsection{Formes du bilan de quantit\'e de mouvement}
Diff\'erentes formes du bilan de quantit\'e de mouvement sont possibles et quatre sont acctuellement disponibles. Si ces formes sont
\'equivalentes au niveau continu, elles peuvent potentiellement donner des r\'esultats diff\'erents du fait de la discr\'etisation spatiale et de
la r\'esolution num\'erique. Ces formes modifient la d\'efinition de la "pression" utilis\'ee pour la r\'esolution de l'\'equation de Poisson
lors de la r\'esolution du bilan de quantit\'e de mouvement (cf paragraphe \ref{subsec:EQ_bilan_QDM}). Les formes disponibles sont les suivantes :
\medskip\newline
\textbf{Forme 1}\newline
\begin{equation}
-\nabla P + \tilde{\mu}\nabla c = -\nabla\left(P - \tilde{\mu}c\right) - c\nabla\tilde{\mu}\label{eq:bilanQDM2}
\end{equation}
\textbf{Forme 2}\newline
\begin{equation}
-\nabla P + \tilde{\mu}\nabla c = -\nabla\left(P+W+c\nabla\cdot\left(\alpha\nabla c\right)\right)+c\nabla\left[\nabla\cdot\left(\alpha\nabla
c\right)\right]
\end{equation}
\textbf{Forme 3}\newline
\begin{equation}
-\nabla P + \tilde{\mu}\nabla c = -\nabla\left(P+W-\alpha\frac{\left(\nabla c\right)^2}{2}+c\nabla\cdot\left(\alpha\nabla
c\right)\right)+c\nabla\left[\nabla\cdot\left(\alpha\nabla c\right)\right]-\nabla\left(\alpha\frac{\left(\nabla c\right)^2}{2}\right)
\end{equation}
\textbf{Forme 4}\newline
\begin{equation}
-\nabla P + \tilde{\mu}\nabla c = -\nabla\left(P+W\right)-\nabla\cdot\left(\alpha\nabla c\right)\nabla c
\end{equation}
La premi\`ere forme (\'equation \ref{eq:bilanQDM2}) est en g\'en\'eral pr\'ef\'er\'ee aux autres, plus historiques. Cette forme pr\'esente en
effet l'avantage num\'erique d'avoir un terme source nul \`a l'\'equilibre, ce dernier \'etant en partticulier caract\'eris\'e par la condition
$\tilde{\mu}=cste$. En revanche, la "pression" $(P-\tilde{\mu}c$ est constante \`a la travers\'ee d'une interface courbe \`a l'\'equilibre, ce
qui ne correspond pas \`a la pression habituelle des physiciens ; la pression habituelle du physicien est en fait, $P$.

\section{R\'esolution num\'erique}
Le syst\`eme d'\'equations \ref{eq:Cahn-Hilliard} \`a \ref{eq:kappa} est r\'esolu num\'eriquement en deux \'etapes principales :\smallskip\newline
1. r\'esolution de l'\'equation de \texttt{Cahn-Hilliard} (\'equation \ref{eq:Cahn-Hilliard}), ce qui permet de d\'eterminer $varphi^{n+1}$ et $\tilde{\mu}^{n+1}$;\smallskip\newline
2. r\'esolution de l'\'equation de bilan de quantit\'e de mouvement (\'equation \ref{eq:bilanQDM}) coupl\'ee \`a la contrainte (\ref{eq:GradU}) par une m\'ethode de
projection qui permet de d\'eterminer $u^{n+1}$ et $P^{n+1}$.\medskip\newline
La r\'esolution de l'\'equation de Cahn-Hilliard peut se faire soit de mani\`ere explicite, soit de mani\`ere implicite. La r\'esolution implicite est effectu\'ee
soit par une m\'ethode du point fixe soit par une m\'ethode de Newton-Krylov et permet essentiellement d'augmenter le pas de temps de stabilit\'e (parfois de
mani\`ere significative).\newline
Les sch\'emas de discr\'etisation en temps des \'equations de Cahn-Hilliard et de bilan de quantit\'e de mouvement peuvent \^etre diff\'erents.

\subsection{Equation de Cahn-Hilliard}
L'avanc\'ee en temps du champ de $c$ s'effectue en deux grandes sous-\'etapes :\smallskip\newline
1. d\'etermination de $c^{n+1/2}$ en tenant compte uniquement du membre de droite de l'\'equation de Cahn-Hilliard ; cette \'etape peut \^etre r\'esolue soit de
mani\`ere explicite, soit de mani\`ere implicite.\smallskip\newline
2. d\'etermination de $c^{n+1}$ en prenant en compte le terme de convection ; c'est pour cette seconde \'etape que l'on peut choisir le sch\'ema en temps (Euler,
Runge-Kutta, \textit{etc.} ).\smallskip\newline
La r\'esolution explicite de la premi\`ere sous-\'etape permet de r\'esoudre l'\'equation suivante :\newline
\begin{equation}
\frac{c^{n+1/2}-c^n}{\Delta t}=\nabla\cdot\left[\kappa\left(c^n\right)\nabla\left(\tilde{\mu}^n+\frac{d\rho}{d\varphi}\frac{\left(u^n\right)^2}{2}\right)\right]
\end{equation}
La r\'esolution implicite m\'erite plus d'explications car elle est bas\'ee sur l'utilisation d'une approximation semi-implicite de $\tilde{\mu}$. Pour tout champ
$\phi$, on note :
\begin{equation}
\phi^{n+1/4}=\theta\phi^{n+1/2}+\left(1-\theta\right)\phi^{n}, avec \theta \in \left[0;1\right]
\end{equation}
Pour des raisons de stabilit\'e et de pr\'ecision, la valeur de $\theta$ est impos\'ee \`a 0.6.
\begin{equation}
\frac{c^{n+1/2}-c^n}{\Delta
t}=\nabla\cdot\left[\kappa\left(c^n\right)\nabla\left(\tilde{\mu}^{n+1/4}+\frac{d\rho}{d\varphi}\frac{\left(u^n\right)^2}{2}\right)\right]\label{eq:Cahn1}
\end{equation}
avec
\begin{equation}
\tilde{\mu}^{n+1/4}=W\left(c^{1/4}\right)+\nabla\cdot\left(\alpha\nabla c^{n+1/4}\right)\label{eq:Cahn2}
\end{equation}
Le syst\`eme d'\'equations \ref{eq:Cahn1} - \ref{eq:Cahn2} est non lin\'eaire (du fait de la non lin\'earit\'e de $W(c)$) et est r\'esolu de
mani\`ere it\'erative soit par une m\'ethode du point fixe, soit par une m\'ethode de Nawton-Krylov (\'egalement appel\'ee m\'ethode GMRES non
lin\'eaire). A noter que, pour des raisons de simplification du syst\`eme non lin\'eaire, la mobilit\'e est toujours d\'etermin\'ee au pas de
temps $n$ et non pas au pas de temps $(n+1)$.

\subsection{Equation de bilan de quantit\'e de mouvement}\label{subsec:EQ_bilan_QDM}
L'\'equation de bilan de quantit\'e de mouvement, coupl\'ee \`a la contrainte de divergence nulle de la vitesse, est r\'esolue par une m\'ethode
de projection dont on rappelle ici les grandes \'etapes. Pour simplifier ici, on consid\`ere uniquement un sch\`ema d'Euler explicite et l'on met
l'\'equation de bilan de quantit\'e de mouvement sous la forme suivante :
\begin{equation}
\rho\frac{\partial u}{\partial t}=-\nabla P + F
\end{equation}
o\`u le vecteur $F$ repr\'esente toutes les forces autres que celle de pression.\newline
Cette \'equation est discr\'etis\'ee de la mani\`ere suivante :
\begin{equation}
\rho^n \frac{u^{n+1}-u^n}{\Delta t}=-\nabla P^{n+1}+F
\end{equation}
o\`u le pas de temps auquel est \'evalu\'e $F$ n'est pas pr\'ecis\'e car cela peut d\'ependre des probl\`emes trait\'es. Cependant, les
d\'ependances en $u$ de $F$ doivent \^etre explicites.\newline
Apr\`es division par $\rho^n$n application de l'op\'erateur de divergence et prise en compte de la condition \ref{eq:GradU}, on obtient l'\'equation de Poisson
sur la pression suivante :
\begin{equation}
\nabla\cdot\left(\frac{1}{\rho^n}\nabla P^{n+1}\right)=\nabla\cdot\left(\frac{F}{\rho^n}\right)
\end{equation}
La matrice en pression associ\'ee \`a la discr\'etisation de cette \'equation d\'epend du champ $\rho^n$ et doit par cons\'equent \^etre
assembl\'ee \`a chaque pas de temps. C'est la raison pour laquelle les m\'ethodes li\'ees aux assembleurs ont dues \^etre modifi\'ees.



