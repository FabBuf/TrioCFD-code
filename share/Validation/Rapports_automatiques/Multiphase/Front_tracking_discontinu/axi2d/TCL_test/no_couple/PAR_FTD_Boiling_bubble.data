# Boiling couped with solid #
dimension 2
PrecisionGeom 1e-18
bidim_axi


domaine dom_fluide

Probleme_FT_Disc_gen pb1

Mailler dom_fluide
{  
 	pave pave1
	{ 
	origine 0. 0. 
	longueurs 1. 1.
	nombre_de_noeuds 251 501
	
	}
	{
         bord left     X = 0.          0. <= Y <= 1.
	 bord right    X = 1.         0. <= Y <= 1.
	 bord up       Y = 1.        0. <= X <= 1.
         #  bord bot      Y = 0.          0. <= X <= 1. #
	 raccord local homogene bot Y = 0.          0. <= X <= 1.
	}
}
transformer dom_fluide x*0.003 y*0.006


VDF dis

Fluide_Incompressible  eau
Lire eau 
{
  	mu champ_uniforme       1 0.00028291
  	rho champ_uniforme      1 958
  	lambda champ_uniforme   1 0.67909
  	cp champ_uniforme       1 4215.7
  
  
}

Fluide_Incompressible vapeur
Lire vapeur
{
  mu champ_uniforme       1 1.2269e-05	
  rho champ_uniforme      1 0.59817
  lambda champ_uniforme   1 0.025096	
  cp champ_uniforme       1 2.0800e3
 
}

Fluide_diphasique fluide
Lire fluide
{
  fluide1 eau
  fluide0 vapeur
  sigma   Champ_Uniforme 1            0.058912	
  chaleur_latente Champ_Uniforme 1    -2256.43e3
}



Schema_Euler_explicite  sch
Lire sch
{
   nb_pas_dt_max 1000000000
   tinit 0.0
   tmax  0.05 # 7e-5 is already unstable sometimes when timestep too large... #
   tcpumax 23.75
   dt_min 1.e-18
   dt_max 1E-8 # 5e-7 is unstable on coa test whereas 1e-8, 1e-7, 2.5e-7 are stable until at least 7e-5 with remesh BEST #
               # 1e-7 is necessary on coa test otherwise it is unstable at 89.4e-4 with remesh BEST #
   dt_impr 2.e-6
   dt_sauv 500
   facsec 1.
   seuil_statio -1
   periode_sauvegarde_securite_en_heures 0.5
}



Champ_Uniforme gravite
Lire gravite 2 0. -9.81
Associate fluide gravite

Navier_stokes_FT_disc                         hydraulique
Transport_interfaces_FT_disc                  interf
convection_diffusion_temperature_ft_disc      thermique
convection_diffusion_temperature_ft_disc      thermique_vapeur 
Associate pb1 dom_fluide
Associate pb1 hydraulique
Associate pb1 thermique
Associate pb1 thermique_vapeur 
Associate pb1 interf
Associate pb1 fluide


Associate pb1 sch
Discretize pb1 dis

system "mkdir -p lata"

Lire pb1
{
	
	hydraulique
	{
	 	modele_turbulence nul
		solveur_pression GCP { precond ssor { omega 1.5 } seuil 1e-12 impr }
		convection { quick }
		diffusion { }
		conditions_initiales { vitesse champ_uniforme 2 0. 0. }
		
		equation_interfaces_proprietes_fluide interf
		equation_temperature_mpoint thermique
		equation_temperature_mpoint_vapeur thermique_vapeur 
		interpol_indic_pour_dI_dt interp_ai_based
     		terme_gravite grad_I  # grad_I or rho_g #
		
		boundary_conditions 
		{
		right   sortie_libre_rho_variable champ_front_uniforme 1 0.
      		bot     paroi_fixe 
      		up      sortie_libre_rho_variable champ_front_uniforme 1 0.
      		left    Symetrie
        	}
	}
	
	
	interf
	{
		type_indic_faces standard
		# interpolation_repere_local #
		methode_interpolation_v vdf_lineaire
		methode_transport vitesse_interpolee hydraulique
	        conditions_initiales { fonction x^2+(y-0.0001*cos(50.0*pi/180.0))^2-0.0001^2 }
		VOFlike_correction_volume 1

		 nb_iterations_correction_volume 1 # to get the correct dI/dt #
      		 nb_lissage_correction_volume 1 # To smooth the dI/dt correction to avoid pikes on the interface #
      		 n_iterations_distance 6
		remaillage {
                    pas 1e-12
                    nb_iter_remaillage 3
                    critere_arete 0.35
                    critere_remaillage 0.35
                    pas_lissage 1e-12
                    relax_barycentrage 0.1
                    facteur_longueur_ideale 1.0
                    nb_iter_barycentrage 1
                    nb_iter_correction_volume 3
                    seuil_dvolume_residuel 1e-15
                    lissage_courbure_coeff -0.02
                    lissage_courbure_iterations_systematique 1
                    lissage_courbure_iterations_si_remaillage 5
			}
		collisions
		{
                active
                juric_pour_tout
                juric_local  phase_continue 1 
                type_remaillage Juric { source_isovaleur indicatrice }
 		}
		boundary_conditions
		{
		 bot    Paroi_FT_disc constant champ_front_fonc_xyz 1 50+90*(x_lt_3.e-5)
      		 right  Paroi_FT_disc Symetrie
      		 up     Paroi_FT_disc Symetrie
      		 left   Paroi_FT_disc Symetrie
		}
	}
	
	thermique
	{
		EQUATION_INTERFACE INTERF
		EQUATION_NAVIER_STOKES HYDRAULIQUE
		PHASE 1
 		STENCIL_WIDTH 8
                DIFFUSION { }
                CONVECTION { QUICK }
                BOUNDARY_CONDITIONS
                {
			bot paroi_temperature_imposee champ_front_Uniforme 1 8.5
			up  FRONTIERE_OUVERTE T_EXT CHAMP_FRONT_UNIFORME 1 0.
			left symetrie
			right  frontiere_ouverte T_ext Champ_front_Fonc_xyz 1 (8.5*(1-erf(y/0.0001)))  
                }
                CONDITIONS_INITIALES { Temperature_thermique Champ_Fonc_xyz dom_fluide 1 (8.5*(1-erf(y/0.0001))) }
	}
		
	thermique_vapeur
	{
		EQUATION_INTERFACE INTERF
		EQUATION_NAVIER_STOKES HYDRAULIQUE
		PHASE 0
 		STENCIL_WIDTH 8
                DIFFUSION { }
                CONVECTION { QUICK }
		
                BOUNDARY_CONDITIONS
                {
			bot paroi_temperature_imposee champ_front_Uniforme 1 8.5
			up  FRONTIERE_OUVERTE T_EXT CHAMP_FRONT_UNIFORME 1 0.
			left  Symetrie
			right PAROI_ADIABATIQUE
                }
                CONDITIONS_INITIALES { TEMPERATURE_THERMIQUE_VAPEUR Champ_Fonc_xyz dom_fluide 1 (8.5*(1-erf(y/0.0001))) }
	}

	 
   postraitement 
   {
      fichier lata/postbis
      champs dt_post 100
      {
         indicatrice_interf
         temperature_thermique
       vitesse
       pression
       mpoint_thermique
      }
                Probes 
               {
                  temperature_probe grav temperature_thermique Periode 1.e-4 segment 400 0. 5.0e-6 0.004 5.0e-6
               # velocity_probe grav VitesseX Periode 1.e-4 segment 100 0. 1.875e-5 0.003 1.875e-5 #           
               }
   }
   
   liste_postraitements
   {
    postraitement_ft_lata post1 { 
     format Lata 
     fichier lata/post 
     champs dt_post 1.0e-5 { 
        VOLUME_MAILLE elem 
        indicatrice_interf elem 
        temperature_thermique elem 
        vitesse faces 
        pression elem 
        mpoint_thermique elem 
        pression_laplacien_d elem 
        second_membre_projection elem 
        interfacial_area elem 
        vitesse_conv_thermique faces 
        vitesse_delta_interface faces 
        terme_convection_vitesse faces 
        terme_diffusion_vitesse faces 
        # flux_tmp_interf faces  #
     } 
     interfaces interf { 
        courbure som 
        vitesse som 
        vitesse_repere_local som 
        COMPO_CONNEXE elem 
        PE elem 
        PE_LOCAL elem 
     } 
    }   
   }
   
	
}


Solve pb1
FIN

			     
